<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Quizzes con Gemini</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f9; color: #333; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 600px; }
        h1 { color: #1a73e8; text-align: center; }
        label { display: block; margin-top: 15px; font-weight: bold; }
        input, button { width: 100%; padding: 12px; margin-top: 8px; border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box; }
        button { background-color: #1a73e8; color: white; border: none; cursor: pointer; font-size: 16px; font-weight: bold; transition: background 0.3s; }
        button:hover { background-color: #1557b0; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }
        #resultado { margin-top: 25px; white-space: pre-wrap; line-height: 1.6; }
        .pregunta { background: #e8f0fe; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 5px solid #1a73e8; }
        .loader { display: none; text-align: center; margin-top: 10px; color: #666; }
    </style>
</head>
<body>

<div class="container">
    <h1>Generador de Preguntas</h1>
    
    <label for="apiKey">1. Pega tu Gemini API Key:</label>
    <input type="password" id="apiKey" placeholder="AIzaSy...">
    <small><a href="https://aistudio.google.com/app/apikey" target="_blank">Consigue tu llave aquí (gratis)</a></small>

    <label for="videoUrl">2. Link de YouTube:</label>
    <input type="text" id="videoUrl" placeholder="https://www.youtube.com/watch?v=...">

    <button id="btnGenerar" onclick="generarPreguntas()">Generar 10 Preguntas</button>

    <div class="loader" id="loader">Analizando video y creando preguntas...</div>
    <div id="resultado"></div>
</div>

<script>
    async function generarPreguntas() {
        const apiKey = document.getElementById('apiKey').value;
        const videoUrl = document.getElementById('videoUrl').value;
        const btn = document.getElementById('btnGenerar');
        const loader = document.getElementById('loader');
        const resultadoDiv = document.getElementById('resultado');

        if (!apiKey || !videoUrl) {
            alert("Por favor, completa la API Key y el link del video.");
            return;
        }

        btn.disabled = true;
        loader.style.display = "block";
        resultadoDiv.innerHTML = "";

        // Prompt diseñado para Gemini
        const prompt = `Analiza el contenido de este video de YouTube: ${videoUrl}. 
        Genera 10 preguntas de opción múltiple (A, B, C, D) basadas estrictamente en el contenido del video. 
        Indica la respuesta correcta al final de cada pregunta. Formatea el resultado con HTML limpio (usa divs para cada pregunta).`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    contents: [{ parts: [{ text: prompt }] }]
                })
            });

            const data = await response.json();
            const textoGenerado = data.candidates[0].content.parts[0].text;
            
            // Limpiar el formato markdown de la respuesta si Gemini lo envía
            resultadoDiv.innerHTML = textoGenerado.replace(/```html|```/g, "");
            
        } catch (error) {
            console.error(error);
            resultadoDiv.innerHTML = "<p style='color:red;'>Error al conectar con la IA. Revisa tu API Key o la conexión.</p>";
        } finally {
            btn.disabled = false;
            loader.style.display = "none";
        }
    }
</script>

</body>
</html>